---           
layout: post
title: Reaping the Benefits of the LoaderManager
date: 2013-08-23 02:20:51 UTC
updated: 2013-08-23 02:20:51 UTC
comments: false
categories: Loaders
---
 
<p><b>Note: <a href="http://www.androiddesignpatterns.com/2012/07/loaders-and-loadermanager-background.html">Check out my new posts on Loaders here!</a> (Since writing this post, I've written extensively on Loaders and the LoaderManager).</b></p> <p>With Android 3.0 came the introduction of the <span style="font-family: 'Courier New', Courier, monospace;">LoaderManager</span> class, an abstract class associated with an <span style="font-family: 'Courier New', Courier, monospace;">Activity</span> or <span style="font-family: 'Courier New', Courier, monospace;">Fragment</span> for managing one or more <span style="font-family: 'Courier New', Courier, monospace;">Loader</span> instances. The <span style="font-family: 'Courier New', Courier, monospace;">LoaderManager</span> class is one of my favorite additions to the Android framework for a number of reasons, but mostly because it <i>significantly</i> reduces code complexity and makes your application run a lot smoother. Implementing data loaders with the <span style="font-family: 'Courier New', Courier, monospace;">LoaderManager</span> is simple to implement, and takes care of everything about lifecycle management so are much less error prone.</p> <p>While applications are free to write their own loaders for loading various types of data, the most common (and simplest) use of the <span style="font-family: 'Courier New', Courier, monospace;">LoaderManager</span> is with a <span style="font-family: 'Courier New', Courier, monospace;">CursorLoader</span>. When done correctly, the <span style="font-family: 'Courier New', Courier, monospace;">CursorLoader</span> class offloads the work of loading data on a thread, and keeps the data persistent during short term activity refresh events, such as an orientation change. In addition to performing the initial query, the <span style="font-family: 'Courier New', Courier, monospace;">CursorLoader</span>&nbsp;registers a <span style="font-family: 'Courier New', Courier, monospace;">ContentObserver</span>&nbsp;with the dataset you requested and calls <span style="font-family: 'Courier New', Courier, monospace;">forceLoad()</span> on itself when the data set changes, and is thus auto-updating. This is extremely convenient for the programmer, as he doesn't have to worry about performing these queries himself. Further, for bigger screens it becomes more important that you query on a separate thread since configuration changes involve recreating the entire view layout, a complex operation that can cause disasters when blocked.</p><a name='more'></a> <p>As mentioned earlier, one could implement his or her class to load data on a separate thread using an <span style="font-family: 'Courier New', Courier, monospace;">AsyncTask</span> or even a <span style="font-family: 'Courier New', Courier, monospace;">Thread</span> (God help us). The point, however, is that the <span style="font-family: 'Courier New', Courier, monospace;">LoaderManager</span> does this all for you, so it's convenient for the developer, less error prone, and simple to implement. Of course it is possible to use an <span style="font-family: 'Courier New', Courier, monospace;">AsyncTask</span>&nbsp;to keep your application UI thread friendly, but it will involve a lot more code, and implementing your class so that it will retain the loaded <span style="font-family: 'Courier New', Courier, monospace;">Cursor</span>&nbsp;over the twists and turns of the <span style="font-family: 'Courier New', Courier, monospace;">Activity</span> lifecycle won't be simple. The bottom line is that <span style="font-family: 'Courier New', Courier, monospace;">LoaderManager</span>&nbsp;will do this automatically for you, as well as taking care of correctly creating and closing the <span style="font-family: 'Courier New', Courier, monospace;">Cursor</span> based on the <span style="font-family: 'Courier New', Courier, monospace;">Activity</span>&nbsp;lifecycle.</p> <p>To use <span style="font-family: 'Courier New', Courier, monospace;">LoaderManager</span> with (or without) the <span style="font-family: 'Courier New', Courier, monospace;">CursorLoader</span> in an app targeting pre-HoneyComb devices, you should make use of the classes provided in the Android Support Package, including the <span style="font-family: 'Courier New', Courier, monospace;">FragmentActivity</span> class. A <span style="font-family: 'Courier New', Courier, monospace;">FragmentActivity</span>&nbsp;is just an <span style="font-family: 'Courier New', Courier, monospace;">Activity</span>&nbsp;that has been created for Android compatibility support, and does not require the use of fragments&nbsp;in your application. When transitioning from an <span style="font-family: 'Courier New', Courier, monospace;">Activity</span>s to <span style="font-family: 'Courier New', Courier, monospace;">FragmentActivity</span>s, be extremely careful that you use the&nbsp;<span style="font-family: 'Courier New', Courier, monospace;">getSupportLoaderManager()</span>&nbsp;instead of <span style="font-family: 'Courier New', Courier, monospace;">getLoaderManager()</span>. <span style="font-family: 'Courier New', Courier, monospace;">FragmentActivity</span> extends <span style="font-family: 'Courier New', Courier, monospace;">Activity</span>, thus inheriting all of its methods, and as a result the compiler will not complain if you accidentally mix up these methods, so be very careful!</p> <p>Leave a comment if you have any questions or criticisms... or just to let me know that you managed to read through this entire post without getting distracted! I'm also open to providing more explicit code samples if anyone asks.</p><img src="http://feeds.feedburner.com/~r/androiddesignpatterns/~4/yxtxxkWaIZw" height="1" width="1"/>